% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions_stats.R
\name{calculate_tom}
\alias{calculate_tom}
\title{Calculate the TOM from a correlation matrix}
\usage{
calculate_tom(cor_mat, signed, version = c("v1", "v2"))
}
\arguments{
\item{cor_mat}{Numerical matrix. The symmetric correlation matrix.}

\item{signed}{Boolean. Do you want to calculate the signed version. If set
to \code{FALSE}, the absolute correlation coefficients will be used.}

\item{version}{String. One of \code{c("v1", "v2")}. Defaults to \code{"v1"}.}
}
\value{
A symmetric matrix of the same dimensions as \code{cor_mat} containing
the topological overlap measures.
}
\description{
Calculate the TOM from a correlation matrix
}
\details{
Calculates the topological overlap matrix from a correlation matrix.
The TOM is defined as:

\strong{Unsigned, v1:}

\deqn{TOM_{ij} = \frac{a_{ij} + \sum_{k \neq i,j} a_{ik} a_{kj}}{\min(k_i, k_j) + 1 - a_{ij}}}

\strong{Signed, v1:}

\deqn{TOM_{ij} = \frac{a_{ij} + \sum_{k \neq i,j} a_{ik} a_{kj}}{\min(k_i, k_j) + 1 - \left|a_{ij}\right|}}

\strong{Unsigned, v2:}

\deqn{TOM_{ij} = 0.5 \left( a_{ij} + \frac{\sum_{k \neq i,j} a_{ik} a_{kj}}{\min(k_i, k_j) + a_{ij}} \right)}

\strong{Signed, v2:}

\deqn{TOM_{ij} = 0.5 \left( a_{ij} + \frac{\sum_{k \neq i,j} a_{ik} a_{kj}}{\min(k_i, k_j) + \left|a_{ij}\right|} \right)}

where \eqn{a_{ij}} is the affinity between nodes \eqn{i} and \eqn{j},
and \eqn{k_i = \sum_j a_{ij}} is the connectivity of node \eqn{i}.
For signed networks, connectivity is calculated as \eqn{k_i = \sum_j \left|a_{ij}\right|}.

Version 2 uses a different normalization approach that scales the shared
neighbor contribution separately before combining it with the direct
connection strength.
}
