% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions_stats.R
\name{calculate_tom_from_exp}
\alias{calculate_tom_from_exp}
\title{Calculate the TOM from an expression matrix}
\usage{
calculate_tom_from_exp(x, signed, version, cor_method)
}
\arguments{
\item{x}{Numerical matrix. The expression matrix. Assumes that columns are
the genes, and rows the samples.}

\item{signed}{Boolean. Do you want to calculate the signed version. If set
to \code{FALSE}, the absolute correlation coefficients will be used.}

\item{version}{String. One of \code{c("v1", "v2")}. Defaults to \code{"v1"}}

\item{cor_method}{String. One of \code{c("pearson", spearman)}. Defaults to
\code{"pearson"}.}
}
\value{
The topological overlap matrix.
}
\description{
Calculate the TOM from an expression matrix
}
\details{
Calculates the topological overlap matrix from an expression matrix.
It will first calculate the specified correlation matrix and then generate
the TOM. The TOM is defined as:

\strong{Unsigned, v1:}

\deqn{TOM_{ij} = \frac{a_{ij} + \sum_{k \neq i,j} a_{ik} a_{kj}}{\min(k_i, k_j) + 1 - a_{ij}}}

\strong{Signed, v1:}

\deqn{TOM_{ij} = \frac{a_{ij} + \sum_{k \neq i,j} a_{ik} a_{kj}}{\min(k_i, k_j) + 1 - \left|a_{ij}\right|}}

\strong{Unsigned, v2:}

\deqn{TOM_{ij} = 0.5 \left( a_{ij} + \frac{\sum_{k \neq i,j} a_{ik} a_{kj}}{\min(k_i, k_j) + a_{ij}} \right)}

\strong{Signed, v2:}

\deqn{TOM_{ij} = 0.5 \left( a_{ij} + \frac{\sum_{k \neq i,j} a_{ik} a_{kj}}{\min(k_i, k_j) + \left|a_{ij}\right|} \right)}

where \eqn{a_{ij}} is the affinity between nodes \eqn{i} and \eqn{j},
and \eqn{k_i = \sum_j a_{ij}} is the connectivity of node \eqn{i}.
For signed networks, connectivity is calculated as \eqn{k_i = \sum_j \left|a_{ij}\right|}.

Version 2 uses a different normalization approach that scales the shared
neighbor contribution separately before combining it with the direct
connection strength.
}
