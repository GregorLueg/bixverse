% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/methods_sc_analysis.R
\name{hotspot_gene_cor_sc}
\alias{hotspot_gene_cor_sc}
\title{Calculate the local pairwise gene-gene correlation}
\usage{
hotspot_gene_cor_sc(
  object,
  embd_to_use = "pca",
  hotspot_params = params_sc_hotspot(),
  no_embd_to_use = NULL,
  cells_to_take = NULL,
  genes_to_take = NULL,
  streaming = FALSE,
  random_seed = 42L,
  .verbose = TRUE
)
}
\arguments{
\item{object}{\code{single_cell_exp} class.}

\item{embd_to_use}{String. The embedding to use. Defaults to \code{"pca"}.}

\item{hotspot_params}{List with vision parameters, see
\code{\link[=params_sc_hotspot]{params_sc_hotspot()}} with the following elements:
\itemize{
\item model - String. Which of the available models to use for the
gene expression. Choices are one of \code{c("danb", "normal", "bernoulli")}.
\item normalise - Boolean. Shall the data be normalised.
\item k - Number of neighbours for the kNN search. Only relevant if you
set regenerate_knn to \code{TRUE}.
\item knn_method - String. Which kNN algorithm to use. One of
\code{c("annoy", "hnsw", "nndescent")}. Defaults to \code{"annoy"}. Only relevant if
you set regenerate_knn to \code{TRUE}.
\item ann_dist - String. Distance metric for the approximate neighbour
search. One of \code{c("cosine", "euclidean")}. Defaults to \code{"cosine"}. Only
relevant if you set regenerate_knn to \code{TRUE}.
\item n_trees - Integer. Number of trees to use for the annoy algorithm.
Only relevant if you set regenerate_knn to \code{TRUE}.
\item search_budget - Integer. Search budget per tree for the annoy
algorithm. Only relevant if you set regenerate_knn to \code{TRUE}.
\item nn_max_iter - Integer. Maximum iterations for NN Descent. Only
relevant if you set regenerate_knn to \code{TRUE} and use
\code{"nndescent"}.
\item rho - Numeric. Sampling rate for NN Descent. Only relevant if you
set regenerate_knn to \code{TRUE} and use \code{"nndescent"}.
\item delta - Numeric. Early termination criterion for NN Descent. Only
relevant if you set regenerate_knn to \code{TRUE} and use \code{"nndescent"}.
}}

\item{no_embd_to_use}{Optional integer. Number of embedding dimensions to
use. If \code{NULL} all will be used.}

\item{cells_to_take}{Optional string vector. If you want to only use
selected cells. If \code{NULL} will default to all cells_to_keep in the class.}

\item{genes_to_take}{Optional string vector. If you wish to limit the
search to a subset of genes. If \code{NULL} will default to all genes in the
class.}

\item{streaming}{Boolean. Shall the data be streamed in. Useful for larger
data sets.}

\item{random_seed}{Integer. Used for reproducibility.}

\item{.verbose}{Boolean. Controls verbosity of the function.}
}
\value{
A \code{sc_hotspot} class that can be used for subsequent analysis.
}
\description{
This method implements the HotSpot approach (see DeTomaso, et al.) to
calculate the local gene-gene correlations and their Z-scores. Ideally, you
want to identify first informative genes with significant local correlation
via \code{\link[=hotspot_autocor_sc]{hotspot_autocor_sc()}}. This function calculates pairwise
between the chosen genes are evaluated using the cell-cell
similarity map, enabling detection of co-expression even when genes are
sparsely expressed in the same manifold regions but rarely in the same cells.
For each gene pair, a local correlation statistic is computed and compared
against a null model where one gene's expression is fixed whilst the other is
assumed independent; Z-scores are calculated bidirectionally and the most
conservative retained.
}
\details{
The function will be executed on the cells that are defined by
\code{\link[=set_cells_to_keep]{set_cells_to_keep()}} if \code{cells_to_take = NULL}. The kNN graph for
this function will be regenerated during the function call as the distances
are not normally stored. Future implementations might be designed to use a
provided kNN graph with distances.

Should a gene not be found in sufficient cells, the pairs with this gene
will be set to 0. Please ensure prior to running the function that you
are only calculating gene-gene auto-correlations that occur in sufficient
cells.
}
