% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extendr-wrappers.R
\name{rs_simulate_dropouts}
\alias{rs_simulate_dropouts}
\title{Sparsify bulkRNAseq like data}
\usage{
rs_simulate_dropouts(
  count_mat,
  dropout_function,
  dropout_midpoint,
  dropout_shape,
  power_factor,
  global_sparsity,
  seed
)
}
\arguments{
\item{count_mat}{Numerical matrix. Original numeric matrix.}

\item{dropout_function}{String. One of \code{c("log", "powerdecay")}. Defines
which function will be used to induce the sparsity.}

\item{dropout_midpoint}{Numeric. Controls the midpoint parameter of the
logistic and power decay function.}

\item{dropout_shape}{Numeric. Controls the shape parameter of the logistic
function.}

\item{power_factor}{Numeric. Controls the power factor of the power decay
function.}

\item{global_sparsity}{Numeric. The global sparsity parameter.}

\item{seed}{Integer. Seed for reproducibility.}
}
\value{
The sparsified matrix based on the provided parameters.
}
\description{
This function takes in a (raw) count matrix (for example from the synthetic
data in bixverse) and applies sparsification to it based on two possible
functions:

\strong{Logistic function:}

With dropout probability defined as:

\if{html}{\out{<div class="sourceCode">}}\preformatted{P(dropout) = clamp(1 / (1 + exp(shape * (ln(exp+1) - ln(midpoint+1)))), 0.3, 0.8) * (1 - global_sparsity) + global_sparsity
}\if{html}{\out{</div>}}

with the following characteristics:
\itemize{
\item Plateaus at ~30\% dropout for high expression genes
\item Partial dropout preserves count structure via binomial thinning
\item Good for preserving variance-mean relationships
}

\strong{Power Decay function:}

With dropout probability defined as:

\if{html}{\out{<div class="sourceCode">}}\preformatted{P(dropout) = (midpoint / (exp + midpoint))^power * scale_factor * (1 - global_sparsity) + global_sparsity
}\if{html}{\out{</div>}}

with the following characteristics:
\itemize{
\item No plateau - high expression genes get substantial dropout
\item Complete dropout only (no partial dropout)
\item More uniform dropout across expression range
}
}
