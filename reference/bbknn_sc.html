<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run BBKNN — bbknn_sc • bixverse</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run BBKNN — bbknn_sc"><meta name="description" content="This function implements the batch-balanced k-nearest neighbour algorithm
from Polański, et al. Briefly, the algorithm generate a KNN index on a per
batch basis and identifies the neighbours of cells for each individual index.
Subsequently, it leverages UMAP connectivity calculations to reduce spurious
connections. For more details, please refer to Polański, et al."><meta property="og:description" content="This function implements the batch-balanced k-nearest neighbour algorithm
from Polański, et al. Briefly, the algorithm generate a KNN index on a per
batch basis and identifies the neighbours of cells for each individual index.
Subsequently, it leverages UMAP connectivity calculations to reduce spurious
connections. For more details, please refer to Polański, et al."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bixverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run BBKNN</h1>

      <div class="d-none name"><code>bbknn_sc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements the batch-balanced k-nearest neighbour algorithm
from Polański, et al. Briefly, the algorithm generate a KNN index on a per
batch basis and identifies the neighbours of cells for each individual index.
Subsequently, it leverages UMAP connectivity calculations to reduce spurious
connections. For more details, please refer to Polański, et al.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bbknn_sc</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">batch_column</span>,</span>
<span>  no_neighbours_to_keep <span class="op">=</span> <span class="fl">15L</span>,</span>
<span>  embd_to_use <span class="op">=</span> <span class="st">"pca"</span>,</span>
<span>  no_embd_to_use <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sc_bbknn_params <span class="op">=</span> <span class="fu"><a href="params_sc_bbknn.html">params_sc_bbknn</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42L</span>,</span>
<span>  .verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><code>single_cell_exp</code> class.</p></dd>


<dt id="arg-batch-column">batch_column<a class="anchor" aria-label="anchor" href="#arg-batch-column"></a></dt>
<dd><p>String. The column with the batch information in the
obs data of the class.</p></dd>


<dt id="arg-no-neighbours-to-keep">no_neighbours_to_keep<a class="anchor" aria-label="anchor" href="#arg-no-neighbours-to-keep"></a></dt>
<dd><p>Integer. Maximum number of neighbours to keep
from the BBKNN algorithm. Due to generating neighbours for each batch, there
might be a large number of generated neighbours. This will only keep the top
<code>no_neighbours_to_keep</code> neighbours.</p></dd>


<dt id="arg-embd-to-use">embd_to_use<a class="anchor" aria-label="anchor" href="#arg-embd-to-use"></a></dt>
<dd><p>String. The embedding to use. Atm, the only option is
<code>"pca"</code>.</p></dd>


<dt id="arg-no-embd-to-use">no_embd_to_use<a class="anchor" aria-label="anchor" href="#arg-no-embd-to-use"></a></dt>
<dd><p>Optional integer. Number of embedding dimensions to
use. If <code>NULL</code> all will be used.</p></dd>


<dt id="arg-sc-bbknn-params">sc_bbknn_params<a class="anchor" aria-label="anchor" href="#arg-sc-bbknn-params"></a></dt>
<dd><p>A list, please see <code><a href="params_sc_bbknn.html">params_sc_bbknn()</a></code>. The
list has the following parameters:</p><ul><li><p>neighbours_within_batch - Integer. Number of neighbours to consider
per batch.</p></li>
<li><p>knn_method - String. One of <code>c("annoy", "hnsw")</code>. Defaults to
<code>"annoy"</code>.</p></li>
<li><p>ann_dist - String. One of <code>c("cosine", "euclidean")</code>. The distance
metric to be used for the approximate neighbour search. Defaults to
<code>"cosine"</code>.</p></li>
<li><p>set_op_mix_ratio - Numeric. Mixing ratio between union (1.0) and
intersection (0.0).</p></li>
<li><p>local_connectivity - Numeric. UMAP connectivity computation
parameter, how many nearest neighbours of each cell are assumed to be fully
connected.</p></li>
<li><p>annoy_n_trees - Integer. Number of trees to use in the generation of
the Annoy index.</p></li>
<li><p>search_budget - Integer. Search budget per tree for the <code>annoy</code>
algorithm.</p></li>
<li><p>trim - Optional integer. Trim the neighbours of each cell to these
many top connectivities. May help with population independence and improve
the tidiness of clustering. If <code>NULL</code>, it defaults to
<code>10 * neighbours_within_batch</code>.</p></li>
</ul></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Integer. Random seed.</p></dd>


<dt id="arg--verbose">.verbose<a class="anchor" aria-label="anchor" href="#arg--verbose"></a></dt>
<dd><p>Boolean. Controls the verbosity of the function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The object with added kNN matrix based on BBKNN and the graph based
on the returned connectivities of the algorithm.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Polański, et al., Bioinformatics, 2020</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregor Lueg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

