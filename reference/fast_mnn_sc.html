<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run fastMNN — fast_mnn_sc • bixverse</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run fastMNN — fast_mnn_sc"><meta name="description" content="This function implements the fast mutual nearest neighbour (MNN) from
Haghverdi, et al. This version works on the PCA embedding and generates
an embedding only and not fully corrected count matrix. The function will
iterate through the batches, identify the MNN and generate correction vectors
and generate a corrected embedding which is added to the function."><meta property="og:description" content="This function implements the fast mutual nearest neighbour (MNN) from
Haghverdi, et al. This version works on the PCA embedding and generates
an embedding only and not fully corrected count matrix. The function will
iterate through the batches, identify the MNN and generate correction vectors
and generate a corrected embedding which is added to the function."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bixverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run fastMNN</h1>

      <div class="d-none name"><code>fast_mnn_sc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements the fast mutual nearest neighbour (MNN) from
Haghverdi, et al. This version works on the PCA embedding and generates
an embedding only and not fully corrected count matrix. The function will
iterate through the batches, identify the MNN and generate correction vectors
and generate a corrected embedding which is added to the function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fast_mnn_sc</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">batch_column</span>,</span>
<span>  <span class="va">batch_hvg_genes</span>,</span>
<span>  fastmnn_params <span class="op">=</span> <span class="fu"><a href="params_sc_fastmnn.html">params_sc_fastmnn</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42L</span>,</span>
<span>  .verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><code>single_cell_exp</code> class.</p></dd>


<dt id="arg-batch-column">batch_column<a class="anchor" aria-label="anchor" href="#arg-batch-column"></a></dt>
<dd><p>String. The column with the batch information in the
obs data of the class.</p></dd>


<dt id="arg-batch-hvg-genes">batch_hvg_genes<a class="anchor" aria-label="anchor" href="#arg-batch-hvg-genes"></a></dt>
<dd><p>Integer vector. These are the highly variable genes,
identified by a batch-aware method. Please refer to
<code><a href="find_hvg_batch_aware_sc.html">find_hvg_batch_aware_sc()</a></code> for more details.</p></dd>


<dt id="arg-fastmnn-params">fastmnn_params<a class="anchor" aria-label="anchor" href="#arg-fastmnn-params"></a></dt>
<dd><p>A list, please see <code><a href="params_sc_fastmnn.html">params_sc_fastmnn()</a></code>. The
list has the following parameters:</p><ul><li><p>k - Integer. Number of mutual nearest neighbours to identify.
Defaults to <code>20L</code>.</p></li>
<li><p>sigma - Numeric. Bandwidth of the Gaussian smoothing kernel (as
proportion of space radius). Defaults to <code>0.1</code>.</p></li>
<li><p>knn_method - String. One of <code>c("annoy", "hnsw")</code>. The method to use
for the approximate nearest neighbour search. Defaults to <code>"annoy"</code>.</p></li>
<li><p>dist_metric - String. One of <code>c("cosine", "euclidean")</code>. The
distance metric to be used for the approximate neighbour search. Defaults
to <code>"cosine"</code>.</p></li>
<li><p>annoy_n_trees - Integer. Number of trees for Annoy index. Defaults
to <code>100L</code>.</p></li>
<li><p>annoy_search_budget - Integer. Search budget per tree for Annoy.
Defaults to <code>100L</code>.</p></li>
<li><p>cos_norm - Logical. Apply cosine normalisation before computing
distances. Defaults to <code>TRUE</code>.</p></li>
<li><p>var_adj - Logical. Apply variance adjustment to avoid kissing
effects. Defaults to <code>TRUE</code>.</p></li>
<li><p>no_pcs - Integer. Number of PCs to use for MNN calculations.
Defaults to <code>30L</code>.</p></li>
<li><p>random_svd - Logical. Use randomised SVD. Defaults to <code>TRUE</code>.</p></li>
</ul></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Integer. Random seed.</p></dd>


<dt id="arg--verbose">.verbose<a class="anchor" aria-label="anchor" href="#arg--verbose"></a></dt>
<dd><p>Boolean. Controls the verbosity of the function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The object with the added fastMNN embeddings to the object.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Haghverdi, et al., Nat Biotechnol, 2018</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregor Lueg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

