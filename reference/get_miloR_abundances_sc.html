<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate an miloR abundance object for differential abundance testing — get_miloR_abundances_sc • bixverse</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate an miloR abundance object for differential abundance testing — get_miloR_abundances_sc"><meta name="description" content="This function implements the miloR differential abundance testing on top
of the kNN graph. The general idea of the approach is to use the kNN graph
generated from the single cell data, generate representative neighbourhoods
and calculate differential abundances within these neighbourhoods. For
further details on the method, please refer to Dann, et al. This function
will take an single_cell_exp class, run the neighbourhood detection,
count the occurrences of a sample and return a sc_miloR class for
subsequent differential abundance testing and further annotations."><meta property="og:description" content="This function implements the miloR differential abundance testing on top
of the kNN graph. The general idea of the approach is to use the kNN graph
generated from the single cell data, generate representative neighbourhoods
and calculate differential abundances within these neighbourhoods. For
further details on the method, please refer to Dann, et al. This function
will take an single_cell_exp class, run the neighbourhood detection,
count the occurrences of a sample and return a sc_miloR class for
subsequent differential abundance testing and further annotations."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bixverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generate an miloR abundance object for differential abundance testing</h1>

      <div class="d-none name"><code>get_miloR_abundances_sc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements the miloR differential abundance testing on top
of the kNN graph. The general idea of the approach is to use the kNN graph
generated from the single cell data, generate representative neighbourhoods
and calculate differential abundances within these neighbourhoods. For
further details on the method, please refer to Dann, et al. This function
will take an <code>single_cell_exp</code> class, run the neighbourhood detection,
count the occurrences of a sample and return a <code>sc_miloR</code> class for
subsequent differential abundance testing and further annotations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_miloR_abundances_sc</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">sample_id_col</span>,</span>
<span>  embd_to_use <span class="op">=</span> <span class="st">"pca"</span>,</span>
<span>  no_embd_to_use <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  miloR_params <span class="op">=</span> <span class="fu"><a href="params_sc_miloR.html">params_sc_miloR</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42L</span>,</span>
<span>  .verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><code>single_cell_exp</code> class.</p></dd>


<dt id="arg-sample-id-col">sample_id_col<a class="anchor" aria-label="anchor" href="#arg-sample-id-col"></a></dt>
<dd><p>Character. The column in the obs table representing
the sample identifier to count.</p></dd>


<dt id="arg-embd-to-use">embd_to_use<a class="anchor" aria-label="anchor" href="#arg-embd-to-use"></a></dt>
<dd><p>Character. The embedding to use for the refinement
procedure. Please use the same here as you used to generate the neighbours!
Defaults to <code>"pca"</code>.</p></dd>


<dt id="arg-no-embd-to-use">no_embd_to_use<a class="anchor" aria-label="anchor" href="#arg-no-embd-to-use"></a></dt>
<dd><p>Optional integer. If you only want to use a subset of
the embedding.</p></dd>


<dt id="arg-milor-params">miloR_params<a class="anchor" aria-label="anchor" href="#arg-milor-params"></a></dt>
<dd><p>A list, please see <code>params_sc_milor()</code>. The
list has the following parameters:</p><ul><li><p>prop - Numeric. Proportion of cells to sample as neighbourhood
indices. Must be in (0,1). Defaults to <code>0.2</code>.</p></li>
<li><p>k_refine - Integer. Number of neighbours to use for refinement.
Defaults to <code>20L</code>.</p></li>
<li><p>refinement_strategy - String. Strategy for refining sampled indices.
One of <code>c("approximate", "bruteforce", "index")</code>. Defaults to
<code>"index"</code>.</p></li>
<li><p>index_type - String. Type of kNN index to use. One of
<code>c("annoy", "hnsw")</code>. Defaults to <code>"annoy"</code>.</p></li>
<li><p>k - Integer. Number of neighbours to consider. Defaults to <code>15L</code>.</p></li>
<li><p>knn_method - String. One of <code>c("annoy", "hnsw")</code>. The method to use
for the approximate nearest neighbour search. Defaults to <code>"annoy"</code>. Note:
<code>"nndescent"</code> is not supported for MiloR!</p></li>
<li><p>ann_dist - String. One of <code>c("cosine", "euclidean")</code>. The distance
metric to be used for the approximate neighbour search. Defaults to
<code>"euclidean"</code>.</p></li>
<li><p>search_budget - Integer. Search budget per tree for Annoy. Defaults
to <code>100L</code>.</p></li>
<li><p>n_trees - Integer. Number of trees to generate for Annoy. Defaults
to <code>100L</code>.</p></li>
<li><p>nn_max_iter - Integer. Maximum iterations for NNDescent. Defaults to
<code>15L</code>.</p></li>
<li><p>rho - Numeric. Sampling rate for NNDescent. Defaults to <code>1.0</code>.</p></li>
<li><p>delta - Numeric. Early termination criterion for NNDescent. Defaults
to <code>0.001</code>.</p></li>
</ul></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Integer. Seed for reproducibility</p></dd>


<dt id="arg--verbose">.verbose<a class="anchor" aria-label="anchor" href="#arg--verbose"></a></dt>
<dd><p>Boolean. Controls verbosity of the method.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Dann, et al., Nat Biotechnol, 2022</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregor Lueg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

