<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Doublet detection with Scrublet — scrublet_sc • bixverse</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Doublet detection with Scrublet — scrublet_sc"><meta name="description" content="This function implements the doublet detection from Scrublet,
see Wolock, et al. Briefly, arteficial doublets are being generated from
the data via random combination of initial cells. Highly variable genes (HVG)
are being identified and the observed cells are being projected on a PCA
space. Subsequently, the simulated doublets are being projected on the same
PCA space given the same HVGs; kNN graphs are being generated and a kNN
classifier is used to assign a probability that a given cell in the original
data is a doublet. For more details, please check the publication."><meta property="og:description" content="This function implements the doublet detection from Scrublet,
see Wolock, et al. Briefly, arteficial doublets are being generated from
the data via random combination of initial cells. Highly variable genes (HVG)
are being identified and the observed cells are being projected on a PCA
space. Subsequently, the simulated doublets are being projected on the same
PCA space given the same HVGs; kNN graphs are being generated and a kNN
classifier is used to assign a probability that a given cell in the original
data is a doublet. For more details, please check the publication."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bixverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Doublet detection with Scrublet</h1>

      <div class="d-none name"><code>scrublet_sc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements the doublet detection from Scrublet,
see Wolock, et al. Briefly, arteficial doublets are being generated from
the data via random combination of initial cells. Highly variable genes (HVG)
are being identified and the observed cells are being projected on a PCA
space. Subsequently, the simulated doublets are being projected on the same
PCA space given the same HVGs; kNN graphs are being generated and a kNN
classifier is used to assign a probability that a given cell in the original
data is a doublet. For more details, please check the publication.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">scrublet_sc</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  scrublet_params <span class="op">=</span> <span class="fu"><a href="params_scrublet.html">params_scrublet</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42L</span>,</span>
<span>  streaming <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_combined_pca <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_pairs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  .verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><code>single_cell_exp</code> class.</p></dd>


<dt id="arg-scrublet-params">scrublet_params<a class="anchor" aria-label="anchor" href="#arg-scrublet-params"></a></dt>
<dd><p>A list with the final scrublet parameters, see
<code><a href="params_scrublet.html">params_scrublet()</a></code> for full details.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Integer. Random seed.</p></dd>


<dt id="arg-streaming">streaming<a class="anchor" aria-label="anchor" href="#arg-streaming"></a></dt>
<dd><p>Boolean. Shall streaming be used during the HVG
calculations. Slower, but less memory usage.</p></dd>


<dt id="arg-return-combined-pca">return_combined_pca<a class="anchor" aria-label="anchor" href="#arg-return-combined-pca"></a></dt>
<dd><p>Boolean. Shall the PCA of the observed cells and
simulated doublets be returned.</p></dd>


<dt id="arg-return-pairs">return_pairs<a class="anchor" aria-label="anchor" href="#arg-return-pairs"></a></dt>
<dd><p>Boolean. Shall the pairs be returned.</p></dd>


<dt id="arg--verbose">.verbose<a class="anchor" aria-label="anchor" href="#arg--verbose"></a></dt>
<dd><p>Boolean. Controls verbosity of the function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>scrublet_res</code> class that has with the following items:</p><ul><li><p>predicted_doublets - Boolean vector indicating which observed cells
predicted as doublets (TRUE = doublet, FALSE = singlet).</p></li>
<li><p>doublet_scores_obs - Numerical vector with the likelihood of being
a doublet for the observed cells.</p></li>
<li><p>doublet_scores_sim - Numerical vector with the likelihood of being
a doublet for the simulated cells.</p></li>
<li><p>doublet_errors_obs - Numerical vector with the standard errors of
the scores for the observed cells.</p></li>
<li><p>z_scores - Z-scores for the observed cells. Represents:
<code>score - threshold / error</code>.</p></li>
<li><p>threshold - Used threshold.</p></li>
<li><p>detected_doublet_rate - Fraction of cells that are called as
doublet.</p></li>
<li><p>detectable_doublet_fraction - Fraction of simulated doublets with
scores above the threshold.</p></li>
<li><p>overall_doublet_rate - Estimated overall doublet rate. Should roughly
match the expected doublet rate.</p></li>
<li><p>pca - Optional PCA embeddings across the original cells and simulated
doublets.</p></li>
<li><p>pair_1 - Optional index of the parent cell 1 of the simulated
doublets.</p></li>
<li><p>pair_2 - Optional index of the parent cell 2 of the simulated
doublets.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wollock, et al., Cell Syst, 2020</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregor Lueg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

