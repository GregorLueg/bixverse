<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Test neighbourhoods for differential abundance — test_nhoods • bixverse</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Test neighbourhoods for differential abundance — test_nhoods"><meta name="description" content="Performs differential abundance testing on single-cell neighbourhoods using
edgeR's quasi-likelihood negative binomial framework. The function fits a
generalised linear model to neighbourhood cell counts, tests for differential
abundance between conditions, and applies spatial FDR correction to account
for overlapping neighbourhoods. This implementation follows the approach
described in Dann et al., using graph-based neighbourhoods to identify
regions of significant compositional changes in single-cell data."><meta property="og:description" content="Performs differential abundance testing on single-cell neighbourhoods using
edgeR's quasi-likelihood negative binomial framework. The function fits a
generalised linear model to neighbourhood cell counts, tests for differential
abundance between conditions, and applies spatial FDR correction to account
for overlapping neighbourhoods. This implementation follows the approach
described in Dann et al., using graph-based neighbourhoods to identify
regions of significant compositional changes in single-cell data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bixverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Test neighbourhoods for differential abundance</h1>

      <div class="d-none name"><code>test_nhoods.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs differential abundance testing on single-cell neighbourhoods using
edgeR's quasi-likelihood negative binomial framework. The function fits a
generalised linear model to neighbourhood cell counts, tests for differential
abundance between conditions, and applies spatial FDR correction to account
for overlapping neighbourhoods. This implementation follows the approach
described in Dann et al., using graph-based neighbourhoods to identify
regions of significant compositional changes in single-cell data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">test_nhoods</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">design</span>,</span>
<span>  <span class="va">design_df</span>,</span>
<span>  coef <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  norm_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TMM"</span>, <span class="st">"RLE"</span>, <span class="st">"logMS"</span><span class="op">)</span>,</span>
<span>  min_mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fdr_weighting <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"k-distance"</span>, <span class="st">"graph-overlap"</span>, <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'sc_miloR'</span></span>
<span><span class="fu">test_nhoods</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">design</span>,</span>
<span>  <span class="va">design_df</span>,</span>
<span>  coef <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  norm_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TMM"</span>, <span class="st">"RLE"</span>, <span class="st">"logMS"</span><span class="op">)</span>,</span>
<span>  min_mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fdr_weighting <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"k-distance"</span>, <span class="st">"graph-overlap"</span>, <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code>sc_miloR</code> object for which to run the differential abundance
analysis.</p></dd>


<dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a></dt>
<dd><p>Formula for the experimental design</p></dd>


<dt id="arg-design-df">design_df<a class="anchor" aria-label="anchor" href="#arg-design-df"></a></dt>
<dd><p>data.frame. Contains the metadata to be used for the
generation of the model matrix.</p></dd>


<dt id="arg-coef">coef<a class="anchor" aria-label="anchor" href="#arg-coef"></a></dt>
<dd><p>Optional string/integer. For more complex experimental designs,
you can specify which coefficient to test. If NULL, tests the last
coefficient in the design matrix (typically the main effect of interest).</p></dd>


<dt id="arg-norm-method">norm_method<a class="anchor" aria-label="anchor" href="#arg-norm-method"></a></dt>
<dd><p>String. Normalisation method to use. One of
<code>c("TMM", "RLE", "logMS")</code>. Defaults to TMM (trimmed mean of M-values).</p></dd>


<dt id="arg-min-mean">min_mean<a class="anchor" aria-label="anchor" href="#arg-min-mean"></a></dt>
<dd><p>Numeric. Minimum mean count threshold for filtering
neighbourhoods. Neighbourhoods with mean counts below this value are excluded.
Defaults to 0 (no filtering).</p></dd>


<dt id="arg-robust">robust<a class="anchor" aria-label="anchor" href="#arg-robust"></a></dt>
<dd><p>Logical. If TRUE, uses robust estimation of the quasi-likelihood
dispersion. Recommended for datasets with potential outliers. Defaults to TRUE.</p></dd>


<dt id="arg-fdr-weighting">fdr_weighting<a class="anchor" aria-label="anchor" href="#arg-fdr-weighting"></a></dt>
<dd><p>String. Spatial FDR weighting scheme. One of
<code>c("k-distance", "graph-overlap", "none")</code>. k-distance uses the distance to
the k-th nearest neighbour, graph-overlap uses neighbourhood overlap counts.
Defaults to k-distance.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The <code>sc_miloR</code> object with added model and results from the
differential abundance analysis.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Dann et al., 2022, Nat Biotechnol</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregor Lueg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

